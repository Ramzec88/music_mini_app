<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üéÅ –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è —Ç–µ–±—è!</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.9.6/lottie.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  <style>
/*
  –û–±—ä—è–≤–ª–µ–Ω–∏–µ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –¥–≤—É—Ö —Ç–µ–º.
  –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç–∞ –ø–æ –≤—Å–µ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—É, –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
*/
:root {
  /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è "–¢–µ–ø–ª–æ–π" —Ç–µ–º—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
  --primary-color: #f46b8a;
  --secondary-color: #e64d6e;
  --text-color: #333;
  --text-secondary-color: #666;

  --gradient-bg: linear-gradient(180deg, #fdd39e, #fbb47a);
  --btn-gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  --btn-hover-gradient: linear-gradient(135deg, var(--secondary-color), #d63d5d);

  --shadow-color: rgba(244, 107, 138, 0.3);
  --shadow-hover-color: rgba(230, 77, 110, 0.4);

  --song-card-bg-gradient: linear-gradient(135deg, #fdd39e20, #fbb47a20);
  --share-modal-btn-color: #333;
  --share-modal-btn-hover-color: white;
  --share-modal-bg: rgba(0,0,0,0.8);
  --share-modal-content-bg: rgba(255, 255, 255, 0.98);
}

/* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è "–ö–æ—Å–º–∏—á–µ—Å–∫–æ–π" —Ç–µ–º—ã */
body.cosmic-theme {
  --primary-color: #667eea;
  --secondary-color: #764ba2;
  --text-color: #fff;
  --text-secondary-color: rgba(255, 255, 255, 0.8);

  --gradient-bg: linear-gradient(180deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
  --btn-gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  --btn-hover-gradient: linear-gradient(135deg, var(--secondary-color), #667eea);

  --shadow-color: rgba(102, 126, 234, 0.3);
  --shadow-hover-color: rgba(118, 75, 162, 0.4);

  --song-card-bg-gradient: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
  --share-modal-btn-color: #333;
  --share-modal-btn-hover-color: white;
  --share-modal-bg: rgba(0,0,0,0.8);
  --share-modal-content-bg: rgba(255, 255, 255, 0.98);
}

/* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–ª–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
body {
  font-family: 'SF Pro Display', sans-serif;
  background: var(--gradient-bg);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow-x: hidden;
  position: relative;
  text-align: center;
  transition: background 0.8s ease;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
h1 {
  color: var(--text-color);
  text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}

.subtitle {
  color: var(--text-secondary-color);
}

body.cosmic-theme .particle {
  background: rgba(255, 255, 255, 0.6);
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.4);
}

/* Theme Switcher Styles */
.theme-switcher {
  position: fixed;
  top: 20px;
  right: 20px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  z-index: 100;
  min-width: 300px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  transition: all 0.4s ease;
  transform: translateX(0);
}

.theme-switcher.hidden {
  transform: translateX(calc(100% + 40px));
  opacity: 0;
  pointer-events: none;
}

.theme-label {
  font-size: 14px;
  font-weight: 600;
  color: var(--share-modal-btn-color);
  margin-bottom: 15px;
  text-align: center;
}

.theme-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 15px;
  margin-bottom: 20px;
}

.theme-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary-color);
  transition: all 0.3s ease;
}

.theme-option.active {
  color: var(--text-color);
  transform: scale(1.1);
}

.theme-preview {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 3px solid transparent;
  transition: all 0.3s ease;
  cursor: pointer;
}

.theme-preview:hover {
  transform: scale(1.1);
  border-color: rgba(0, 0, 0, 0.2);
}

.theme-preview.active {
  border-color: var(--text-color);
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
}

.peach-preview {
  background: linear-gradient(135deg, #fdd39e, #f46b8a);
}

.cosmic-preview {
  background: linear-gradient(135deg, #667eea, #f093fb);
}

.theme-slider {
  position: relative;
}

.theme-checkbox {
  display: none;
}

.theme-slider-label {
  display: block;
  width: 60px;
  height: 30px;
  background: var(--btn-gradient);
  border-radius: 15px;
  cursor: pointer;
  position: relative;
  transition: all 0.4s ease;
  box-shadow: 0 4px 15px var(--shadow-color);
}

.theme-checkbox:checked + .theme-slider-label {
  background: var(--btn-gradient);
  box-shadow: 0 4px 15px var(--shadow-color);
}

.theme-slider-button {
  position: absolute;
  top: 3px;
  left: 3px;
  width: 24px;
  height: 24px;
  background: white;
  border-radius: 50%;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.theme-checkbox:checked + .theme-slider-label .theme-slider-button {
  transform: translateX(30px);
}

.apply-theme-btn {
  width: 100%;
  background: linear-gradient(135deg, #11998e, #38ef7d);
  color: white;
  border: none;
  border-radius: 15px;
  padding: 12px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
}

.apply-theme-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(17, 153, 142, 0.4);
}

/* Floating particles background */
.particles {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

.particle {
  position: absolute;
  width: 6px;
  height: 6px;
  background: rgba(255, 255, 255, 0.4);
  border-radius: 50%;
  animation: float-particle 8s infinite ease-in-out;
}

@keyframes float-particle {
  0%, 100% { 
    transform: translateY(0px) translateX(0px) rotate(0deg); 
    opacity: 0.2; 
  }
  25% { 
    transform: translateY(-30px) translateX(20px) rotate(90deg); 
    opacity: 0.6; 
  }
  50% { 
    transform: translateY(-60px) translateX(-10px) rotate(180deg); 
    opacity: 0.8; 
  }
  75% { 
    transform: translateY(-30px) translateX(-20px) rotate(270deg); 
    opacity: 0.6; 
  }
}

.main-content {
  position: relative;
  z-index: 1;
  animation: fadeInUp 1.2s ease-out;
}

h1 {
  font-size: clamp(28px, 7vw, 42px);
  font-weight: 700;
  margin-bottom: 15px;
  text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  animation: fadeInUp 1s ease-out;
}

.subtitle {
  font-size: clamp(16px, 4vw, 20px);
  margin-bottom: 40px;
  font-weight: 500;
  animation: fadeInUp 1s ease-out 0.3s both;
}

#envelope-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 30px;
  animation: fadeInUp 1s ease-out 0.6s both;
}

#envelope {
  width: clamp(250px, 55vw, 380px);
  height: clamp(250px, 55vw, 380px);
  filter: drop-shadow(0 15px 35px rgba(0, 0, 0, 0.2));
  animation: float 4s ease-in-out infinite;
  transition: transform 0.4s ease;
  cursor: pointer;
}

#envelope:hover {
  transform: scale(1.05) translateY(-5px);
  filter: drop-shadow(0 20px 45px rgba(0, 0, 0, 0.25));
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-15px); }
}

.open-btn {
  background: var(--btn-gradient);
  color: white;
  border: none;
  border-radius: 50px;
  padding: 18px 36px;
  font-size: clamp(16px, 4vw, 20px);
  font-weight: 700;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  box-shadow: 0 8px 25px var(--shadow-color);
  position: relative;
  overflow: hidden;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.open-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.6s;
}

.open-btn:hover::before {
  left: 100%;
}

.open-btn:hover {
  background: var(--btn-hover-gradient);
  box-shadow: 0 15px 35px var(--shadow-hover-color);
  transform: translateY(-3px) scale(1.05);
}

.open-btn:active {
  transform: translateY(-1px) scale(1.02);
}

#song-card {
  position: fixed;
  /* –î–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è Flexbox –∏—Å–ø–æ–ª—å–∑—É–µ–º inset: 0 */
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  
  display: flex; /* –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º Flexbox */
  align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
  justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
  /* –£–±–∏—Ä–∞–µ–º transform, —Ç–∞–∫ –∫–∞–∫ Flexbox –¥–µ–ª–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–º */
  transform: scale(0);
  width: auto;
  max-width: 100%;
  background: transparent;
  opacity: 0;
  transition: all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
  z-index: 10;
  text-align: center;
}

#song-card.show {
  opacity: 1;
  transform: scale(1);
}

.song-card-content {
  width: clamp(280px, 85vw, 360px); /* –£–º–µ–Ω—å—à–∞–µ–º —à–∏—Ä–∏–Ω—É */
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(30px);
  border-radius: 25px;
  padding: 35px 25px; /* –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã */
  box-shadow: 0 25px 60px rgba(0, 0, 0, 0.25);
  border: 1px solid rgba(255, 255, 255, 0.4);
  margin: 20px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø—ã –æ—Ç –∫—Ä–∞–µ–≤ —ç–∫—Ä–∞–Ω–∞ */
}

#song-card h2 {
  font-size: clamp(24px, 6vw, 32px);
  margin-bottom: 15px;
  background: var(--btn-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-weight: 700;
}

#song-card p {
  color: var(--text-secondary-color);
  font-size: clamp(14px, 3.5vw, 16px);
  margin-bottom: 25px;
  line-height: 1.6;
  font-weight: 500;
}

.song-info {
  background: var(--song-card-bg-gradient);
  border-radius: 20px;
  padding: 25px;
  margin: 25px 0;
  border-left: 5px solid var(--primary-color);
  backdrop-filter: blur(10px);
}

.song-title {
  font-weight: 700;
  color: var(--text-color);
  margin-bottom: 8px;
  font-size: clamp(16px, 4vw, 18px);
}

.song-artist {
  color: var(--text-secondary-color);
  font-size: clamp(12px, 3vw, 14px);
  font-weight: 500;
}

.controls {
  display: flex;
  flex-direction: row;
  gap: 15px;
  align-items: center;
  justify-content: center;
  margin-top: 25px;
  flex-wrap: wrap;
}

.play-btn {
  background: var(--btn-gradient);
  color: white;
  border: none;
  border-radius: 50%;
  width: 80px;
  height: 80px;
  font-size: 24px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.4s ease;
  box-shadow: 0 8px 25px var(--shadow-color);
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

.play-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s;
}

.play-btn:hover::before {
  left: 100%;
}

.play-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 35px var(--shadow-hover-color);
}

.download-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  text-decoration: none;
  background: var(--btn-gradient);
  color: white;
  border-radius: 50%;
  width: 80px;
  height: 80px;
  font-size: 24px;
  font-weight: 700;
  transition: all 0.4s ease;
  box-shadow: 0 6px 20px var(--shadow-color);
}

.download-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 30px var(--shadow-hover-color);
  background: var(--btn-hover-gradient);
}

.share-section {
  margin-top: 30px;
  padding-top: 25px;
  border-top: 1px solid var(--primary-color);
}

.share-text {
  color: var(--text-secondary-color);
  font-size: clamp(12px, 3vw, 14px);
  margin-bottom: 15px;
  font-weight: 500;
}

.share-btn {
  background: var(--btn-gradient);
  color: white;
  border: none;
  border-radius: 50px;
  padding: 14px 28px;
  font-size: clamp(12px, 3.5vw, 14px);
  font-weight: 700;
  cursor: pointer;
  transition: all 0.4s ease;
  box-shadow: 0 6px 20px var(--shadow-color);
  width: 100%;
  max-width: 280px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin: 0 auto;
}

.share-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 30px var(--shadow-hover-color);
  background: var(--btn-hover-gradient);
}

.close-btn {
  position: absolute;
  top: 20px;
  right: 25px;
  background: none;
  border: none;
  font-size: 28px;
  color: #999;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 35px;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.close-btn:hover {
  color: var(--primary-color);
  background: rgba(244, 107, 138, 0.1);
  transform: rotate(90deg);
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" */
.share-modal {
  position: fixed; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%;
  background: var(--share-modal-bg);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(10px);
  animation: fadeIn 0.3s ease-out;
}

.share-modal-content {
  background: var(--share-modal-content-bg);
  backdrop-filter: blur(20px);
  border-radius: 25px;
  padding: 35px;
  max-width: 380px;
  width: 90%;
  box-shadow: 0 25px 50px rgba(0,0,0,0.3);
  border: 1px solid rgba(255, 255, 255, 0.3);
  animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  text-align: center;
}

.share-modal-title {
  margin: 0 0 25px 0;
  color: var(--share-modal-btn-color);
  font-size: 22px;
  font-weight: 700;
  background: var(--btn-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.share-modal-btn {
  display: block; 
  width: 100%;
  padding: 16px; 
  margin-bottom: 12px;
  text-decoration: none; 
  color: var(--share-modal-btn-color); 
  border: 2px solid var(--primary-color); 
  border-radius: 15px;
  text-align: center; 
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
  font-weight: 600;
  font-size: 15px;
  background: transparent;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.share-modal-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: var(--btn-gradient);
  transition: left 0.4s ease;
  z-index: -1;
}

.share-modal-btn:hover::before {
  left: 0;
}

.share-modal-btn:hover {
  color: var(--share-modal-btn-hover-color) !important;
  border-color: transparent !important;
  transform: translateY(-2px);
  box-shadow: 0 8px 25px var(--shadow-color);
}

.share-modal-close-btn {
  width: 100%; 
  padding: 16px; 
  margin-top: 20px; 
  background: linear-gradient(135deg, #e0e0e0, #f5f5f5);
  border: none; 
  border-radius: 15px; 
  cursor: pointer; 
  font-weight: 600;
  font-size: 15px;
  color: #666;
  transition: all 0.3s ease;
}

.share-modal-close-btn:hover {
  background: linear-gradient(135deg, #d0d0d0, #e5e5e5);
  transform: translateY(-2px);
}

.hidden {
  opacity: 0 !important;
  pointer-events: none !important;
  transform: scale(0) !important;
  transition: opacity 0.4s ease, transform 0.4s ease;
}

.audio-visualizer {
  width: 100%;
  height: 70px;
  background: var(--btn-gradient);
  border-radius: 15px;
  margin: 20px 0;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

.wave-animation {
  position: absolute;
  width: 200%;
  height: 100%;
  background: repeating-linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.1) 0px,
    rgba(255, 255, 255, 0.3) 15px,
    rgba(255, 255, 255, 0.1) 30px
  );
  animation: wave 3s linear infinite;
  opacity: 0;
  transition: opacity 0.4s ease;
}

.wave-animation.playing {
  opacity: 1;
}

@keyframes wave {
  0% { transform: translateX(-50%); }
  100% { transform: translateX(0%); }
}

.visualizer-text {
  color: white;
  font-weight: 700;
  z-index: 1;
  font-size: clamp(12px, 3vw, 14px);
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(40px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes slideUp {
  from { opacity: 0; transform: translateY(30px) scale(0.9); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}
@keyframes slideDown {
  from { opacity: 1; transform: translateY(0) scale(1); }
  to { opacity: 0; transform: translateY(30px) scale(0.9); }
}


/* Enhanced responsive design */
@media (max-width: 768px) {
  .main-content {
    padding: 0 20px;
  }

  #song-card {
    margin: 20px;
    width: calc(100vw - 40px);
    max-width: 420px;
    padding: 35px 25px;
  }

  .controls {
    gap: 20px;
  }

  .play-btn, .download-btn {
    width: 70px;
    height: 70px;
    font-size: 20px;
  }

  .theme-switcher {
    top: 10px;
    right: 10px;
    min-width: 280px;
    padding: 15px;
  }

  .theme-toggle {
    gap: 10px;
  }

  .theme-preview {
    width: 35px;
    height: 35px;
  }
}

@media (max-width: 480px) {
  #envelope {
    width: clamp(200px, 70vw, 300px);
    height: clamp(200px, 70vw, 300px);
  }

  .open-btn {
    padding: 16px 28px;
    font-size: 16px;
  }

  #song-card {
    padding: 30px 20px;
  }

  .controls {
    gap: 15px;
  }

  .play-btn, .download-btn {
    width: 60px;
    height: 60px;
    font-size: 18px;
  }
}

/* Loading state */
.loading {
  opacity: 0.7;
  pointer-events: none;
}

.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin: -10px 0 0 -10px;
  border: 2px solid transparent;
  border-top: 2px solid white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>
  
  <div class="theme-switcher" id="theme-switcher">
    <div class="theme-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –ø–æ–ª—É—á–∞—Ç–µ–ª—è:</div>
    <div class="theme-toggle">
      <div class="theme-option" data-theme="peach">
        <div class="theme-preview peach-preview active"></div>
        <span>–¢–µ–ø–ª–∞—è</span>
      </div>
      <div class="theme-slider">
        <input type="checkbox" id="theme-toggle" class="theme-checkbox">
        <label for="theme-toggle" class="theme-slider-label">
          <span class="theme-slider-button"></span>
        </label>
      </div>
      <div class="theme-option" data-theme="cosmic">
        <div class="theme-preview cosmic-preview"></div>
        <span>–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è</span>
      </div>
    </div>
    <button class="apply-theme-btn" id="apply-theme">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏ —Å–∫—Ä—ã—Ç—å</button>
  </div>

  <div class="main-content">
    <h1>üéÅ –î–ª—è —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫!</h1>
    <p class="subtitle">–û—Ç–∫—Ä–æ–π –∏ –ø–æ—Å–ª—É—à–∞–π —Å–≤–æ—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–µ—Å–Ω—é ‚ú®</p>

    <div id="envelope-container">
      <div id="envelope"></div>
      <button id="open-btn" class="open-btn">üéµ –û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫</button>
    </div>
  </div>

  <div id="song-card" class="hidden">
  <div class="song-card-content">
    <button class="close-btn" id="close-btn">√ó</button>
    <h2>üéâ –° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –ê–ª–µ–∫—Å–µ–π!</h2>
    <p>–≠—Ç–∞ –ø–µ—Å–Ω—è —Å–æ–∑–¥–∞–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±—è! –ù–∞—Å–ª–∞–¥–∏—Å—å —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π üé∂</p>
    
    <div class="song-info">
      <div class="song-title">üéµ "Happy Birthday Alexey"</div>
      <div class="song-artist">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è ‚Ä¢ –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ –¥–ª—è —Ç–µ–±—è</div>
    </div>

    <div class="audio-visualizer">
      <div class="wave-animation" id="wave-animation"></div>
      <span class="visualizer-text">üéµ –¢–≤–æ—è –ø–µ—Å–Ω—è –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—é</span>
    </div>

    <div class="controls">
      <button id="play-btn" class="play-btn">‚ñ∂Ô∏è</button>
      <a href="#" class="download-btn" id="download-link" title="–°–∫–∞—á–∞—Ç—å –ø–µ—Å–Ω—é">üíæ</a>
    </div>

    <div class="share-section">
      <p class="share-text">–ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ø–æ–¥–∞—Ä–æ–∫? –ü–æ–¥–µ–ª–∏—Å—å —Å –¥—Ä—É–∑—å—è–º–∏! üéÅ</p>
      <button class="share-btn" id="share-btn">
        <span>üì§</span>
        <span>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø–æ–¥–∞—Ä–∫–æ–º</span>
      </button>
    </div>

    <audio id="audio" preload="auto">
      <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSMFl6fX7O6QQAoUXrTp66hVFAlGn+DyvmAabjmO0/LKeSMFl6fX7O6QQAoUXrTp66hVFAlGn+DyvmAaBkGH1++2ayEGl6fX7O6QQAoUXrTp66hVFAlGn+DyvmAaBkGH1++2ayEGJH7I7dqPPAcTXbPr7alXGQdDnt/yuV8aGDBnzfHZiyIGxZPJ8+fJhEALJYbC8tiIL2" type="audio/wav">
      –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
    </audio>
  </div>
</div>

<!-- Share Modal -->
<div id="share-modal" class="share-modal hidden">
  <div class="share-modal-content">
    <h3 class="share-modal-title">üéÅ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø–æ–¥–∞—Ä–∫–æ–º</h3>
    <div id="share-options"></div>
    <button class="share-modal-close-btn" id="share-modal-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
// Initialize Lottie animation with fallback
let envelope;
try {
  // Since we can't load external JSON in artifacts, we'll use a fallback
  document.getElementById('envelope').innerHTML = `
    <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 120px; background: linear-gradient(135deg, #fdd39e, #fbb47a); border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); transition: all 0.3s ease;">
      üíå
    </div>
  `;
} catch (error) {
  console.log('Lottie failed to load, using fallback');
  document.getElementById('envelope').innerHTML = `
    <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 120px; background: linear-gradient(135deg, #fdd39e, #fbb47a); border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); transition: all 0.3s ease;">
      üíå
    </div>
  `;
}

// Window load effect
window.addEventListener('load', () => {
  document.getElementById('envelope').style.transform = 'scale(0.95)';
  setTimeout(() => {
    document.getElementById('envelope').style.transform = 'scale(1)';
  }, 400);
});

// State variables
let isOpen = false;
let isPlaying = false;
const songCard = document.getElementById('song-card');
const audio = document.getElementById('audio');
const playBtn = document.getElementById('play-btn');
const openBtn = document.getElementById('open-btn');
const closeBtn = document.getElementById('close-btn');
const waveAnimation = document.getElementById('wave-animation');

// Theme switching functionality
const themeToggle = document.getElementById('theme-toggle');
const themeSwitcher = document.getElementById('theme-switcher');
const applyThemeBtn = document.getElementById('apply-theme');
const peachOption = document.querySelector('[data-theme="peach"]');
const cosmicOption = document.querySelector('[data-theme="cosmic"]');
const peachPreview = document.querySelector('.peach-preview');
const cosmicPreview = document.querySelector('.cosmic-preview');

// Initialize theme state
let currentTheme = 'peach';

function updateThemeUI() {
  if (currentTheme === 'peach') {
    peachOption.classList.add('active');
    cosmicOption.classList.remove('active');
    peachPreview.classList.add('active');
    cosmicPreview.classList.remove('active');
    themeToggle.checked = false;
  } else {
    cosmicOption.classList.add('active');
    peachOption.classList.remove('active');
    cosmicPreview.classList.add('active');
    peachPreview.classList.remove('active');
    themeToggle.checked = true;
  }
}

function applyTheme(theme) {
  if (theme === 'cosmic') {
    document.body.classList.add('cosmic-theme');
  } else {
    document.body.classList.remove('cosmic-theme');
  }
  currentTheme = theme;
  updateThemeUI();
  updateConfettiColors();
}

function updateConfettiColors() {
  if (currentTheme === 'cosmic') {
    window.confettiColors = ['#667eea', '#764ba2', '#f093fb', '#ffffff', '#e0c3fc'];
  } else {
    window.confettiColors = ['#fdd39e', '#fbb47a', '#f46b8a', '#e64d6e', '#ffffff'];
  }
}

// Theme toggle event listener
themeToggle.addEventListener('change', () => {
  applyTheme(themeToggle.checked ? 'cosmic' : 'peach');
});

// Theme preview click handlers
peachPreview.addEventListener('click', () => {
  applyTheme('peach');
});

cosmicPreview.addEventListener('click', () => {
  applyTheme('cosmic');
});

// Apply and hide theme switcher
applyThemeBtn.addEventListener('click', () => {
  themeSwitcher.classList.add('hidden');
  
  const originalText = applyThemeBtn.textContent;
  applyThemeBtn.textContent = '‚ú® –¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!';
  setTimeout(() => {
    applyThemeBtn.textContent = originalText;
  }, 2000);
});

// Show theme switcher on double click (only if not locked)
document.addEventListener('dblclick', (e) => {
  if (e.ctrlKey || e.metaKey) {
    themeSwitcher.classList.remove('hidden');
  }
});

// Initialize theme from URL parameter
function initializeTheme() {
  const urlParams = new URLSearchParams(window.location.search);
  const urlTheme = urlParams.get('theme');
  const isThemeLocked = urlParams.get('locked') === 'true';
  
  const initialTheme = urlTheme || 'peach';
  applyTheme(initialTheme);
  
  // If theme is locked, hide the theme switcher immediately
  if (isThemeLocked) {
    themeSwitcher.classList.add('hidden');
    console.log('Theme locked:', initialTheme);
  } else {
    // Auto-hide theme switcher after 10 seconds if no interaction
    setTimeout(() => {
      if (!themeSwitcher.classList.contains('hidden')) {
        themeSwitcher.style.opacity = '0.7';
      }
    }, 10000);
  }
}

// Create enhanced floating particles
function createParticles() {
  const particles = document.getElementById('particles');
  for (let i = 0; i < 60; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.top = Math.random() * 100 + '%';
    particle.style.animationDelay = Math.random() * 8 + 's';
    particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
    particles.appendChild(particle);
  }
}

// Enhanced confetti celebration
function celebrationEffect() {
  const duration = 1800;
  const animationEnd = Date.now() + duration;
  const colors = window.confettiColors || ['#fdd39e', '#fbb47a', '#f46b8a', '#e64d6e', '#ffffff'];
  
  const defaults = { 
    startVelocity: 45,
    spread: 360, 
    ticks: 100,
    zIndex: 999,
    colors: colors,
    gravity: 1.0,
    scalar: 1.2
  };

  function randomInRange(min, max) {
    return Math.random() * (max - min) + min;
  }

  function initialBurst() {
    const count = 120;
    confetti(Object.assign({}, defaults, {
      particleCount: count,
      spread: 100,
      origin: { x: 0.5, y: 0.6 }
    }));
  }

  const interval = setInterval(function() {
    const timeLeft = animationEnd - Date.now();

    if (timeLeft <= 0) {
      return clearInterval(interval);
    }

    const particleCount = 60 * (timeLeft / duration);

    confetti(Object.assign({}, defaults, {
      particleCount: particleCount,
      spread: 80,
      origin: { x: randomInRange(0.1, 0.3), y: randomInRange(0.5, 0.7) }
    }));
    confetti(Object.assign({}, defaults, {
      particleCount: particleCount,
      spread: 80,
      origin: { x: randomInRange(0.7, 0.9), y: randomInRange(0.5, 0.7) }
    }));
    
    if (timeLeft > duration * 0.5) {
      confetti(Object.assign({}, defaults, {
        particleCount: particleCount * 1.5,
        spread: 120,
        origin: { x: randomInRange(0.4, 0.6), y: randomInRange(0.4, 0.6) }
      }));
    }
  }, 300);

  initialBurst();
  setTimeout(() => initialBurst(), 600);
}

// Open envelope with enhanced animation
openBtn.addEventListener('click', () => {
  if (!isOpen) {
    openBtn.classList.add('loading');
    openBtn.textContent = '‚ú® –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...';
    openBtn.disabled = true;

    const envelopeEl = document.getElementById('envelope');
    envelopeEl.style.transform = 'rotateY(180deg) scale(1.1)';
    setTimeout(showSongCard, 800);
  } else {
    closeSongCard();
  }
});

function showSongCard() {
  isOpen = true;
  
  celebrationEffect();
  
  setTimeout(() => {
    songCard.classList.remove('hidden');
    setTimeout(() => songCard.classList.add('show'), 50);
  }, 1500);
  
  setTimeout(() => {
    openBtn.classList.remove('loading');
    openBtn.textContent = 'üîí –ó–∞–∫—Ä—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫';
    openBtn.disabled = false;
  }, 2000);
}

// Close song card with cleanup
closeBtn.addEventListener('click', closeSongCard);

function closeSongCard() {
  songCard.classList.remove('show');
  setTimeout(() => {
    songCard.classList.add('hidden');
    isOpen = false;
    openBtn.textContent = 'üéµ –û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫';
    
    document.getElementById('envelope').style.transform = 'rotateY(0deg) scale(1)';
    
    if (isPlaying) {
      audio.pause();
      audio.currentTime = 0;
      isPlaying = false;
      playBtn.textContent = '‚ñ∂Ô∏è';
      waveAnimation.classList.remove('playing');
    }
  }, 500);
}

// Enhanced play/pause functionality
playBtn.addEventListener('click', () => {
  if (audio.paused) {
    audio.play().then(() => {
      isPlaying = true;
      playBtn.textContent = '‚è∏Ô∏è';
      waveAnimation.classList.add('playing');
    }).catch(error => {
      console.log('Audio play failed:', error);
      playBtn.textContent = '‚ùå';
      setTimeout(() => {
        playBtn.textContent = '‚ñ∂Ô∏è';
      }, 2000);
    });
  } else {
    audio.pause();
    isPlaying = false;
    playBtn.textContent = '‚ñ∂Ô∏è';
    waveAnimation.classList.remove('playing');
  }
});

// Audio event handlers
audio.addEventListener('ended', () => {
  isPlaying = false;
  playBtn.textContent = 'üîÅ';
  waveAnimation.classList.remove('playing');
});

// Share functionality
const shareModal = document.getElementById('share-modal');
const shareOptionsContainer = document.getElementById('share-options');
const shareModalCloseBtn = document.getElementById('share-modal-close-btn');
const shareBtn = document.getElementById('share-btn');

shareBtn.addEventListener('click', async () => {
  const shareUrl = generateShareUrl();
  const shareData = {
    title: 'üéÅ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫!',
    text: '–ü–æ—Å–º–æ—Ç—Ä–∏, –∫–∞–∫–æ–π –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ —è –ø–æ–ª—É—á–∏–ª! –≠—Ç–æ –º–æ—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–µ—Å–Ω—è! üéµ‚ú®',
    url: shareUrl
  };

  if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
    try {
      await navigator.share(shareData);
      
      themeSwitcher.classList.add('hidden');
      
      const originalText = shareBtn.innerHTML;
      shareBtn.innerHTML = '<span>‚úÖ</span><span>–ü–æ–¥–µ–ª–∏–ª—Å—è!</span>';
      setTimeout(() => {
        shareBtn.innerHTML = originalText;
      }, 2000);
    } catch (err) {
      if (err.name !== 'AbortError') {
        showFallbackShareModal();
      }
    }
  } else {
    showFallbackShareModal();
  }
});

function generateShareUrl() {
  const baseUrl = window.location.origin + window.location.pathname;
  const theme = currentTheme;
  const locked = 'true';
  
  return `${baseUrl}?theme=${theme}&locked=${locked}`;
}

function showFallbackShareModal() {
  const shareUrl = generateShareUrl();
  const text = '–ü–æ—Å–º–æ—Ç—Ä–∏, –∫–∞–∫–æ–π –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ —è –ø–æ–ª—É—á–∏–ª! –≠—Ç–æ –º–æ—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–µ—Å–Ω—è! üéµ‚ú®';

  const shareOptions = [
    { name: 'üì± WhatsApp', url: `https://wa.me/?text=${encodeURIComponent(text)}%20${encodeURIComponent(shareUrl)}` },
    { name: '‚úàÔ∏è Telegram', url: `https://telegram.me/share/url?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(text)}` },
    { name: 'üîµ VKontakte', url: `https://vk.com/share.php?url=${encodeURIComponent(shareUrl)}&title=${encodeURIComponent(text)}` },
    { name: 'üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É', action: 'copy', url: '#' }
  ];

  shareOptionsContainer.innerHTML = shareOptions.map(option => `
    <a href="${option.url}" 
       class="share-modal-btn" 
       data-action="${option.action || 'link'}"
       data-share-url="${shareUrl}">
      ${option.name}
    </a>
  `).join('');

  shareModal.classList.remove('hidden');
}

// Handle copy action
shareOptionsContainer.addEventListener('click', (e) => {
  const btn = e.target.closest('.share-modal-btn');
  if (btn && btn.dataset.action === 'copy') {
    e.preventDefault();
    const shareUrl = btn.dataset.shareUrl || generateShareUrl();
    
    navigator.clipboard.writeText(shareUrl).then(() => {
      themeSwitcher.classList.add('hidden');
      
      const originalText = btn.innerHTML;
      btn.innerHTML = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
      setTimeout(() => {
        btn.innerHTML = originalText;
      }, 2500);
    });
  } else if (btn && btn.dataset.action === 'link') {
    themeSwitcher.classList.add('hidden');
  }
});

shareModalCloseBtn.addEventListener('click', () => {
  shareModal.classList.add('hidden');
});

// Enhanced download functionality
document.getElementById('download-link').addEventListener('click', (e) => {
  e.preventDefault();
  
  // Create a simple beep sound for demo
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.frequency.value = 800;
  gainNode.gain.setValueAtTime(0, audioContext.currentTime);
  gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.01);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
  
  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + 0.5);
  
  const btn = e.target.closest('.download-btn');
  const originalText = btn.innerHTML;
  btn.innerHTML = '‚úÖ';
  setTimeout(() => {
    btn.innerHTML = originalText;
  }, 3000);
});

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if (e.code === 'Space' && isOpen) {
    e.preventDefault();
    playBtn.click();
  }
  if (e.code === 'Escape' && isOpen) {
    closeSongCard();
  }
  if (e.code === 'Enter' && !isOpen) {
    openBtn.click();
  }
});

// Click envelope to open
document.getElementById('envelope').addEventListener('click', () => {
  if (!isOpen) {
    openBtn.click();
  }
});

// Initialize everything
createParticles();
initializeTheme();
</script>
</body>
</html>
